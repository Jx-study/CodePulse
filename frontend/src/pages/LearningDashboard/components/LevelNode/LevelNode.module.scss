.levelNode {
  position: absolute;
  width: 5rem; // 80px
  height: 5rem; // 80px
  border-radius: $radius-full;
  @include flex(center, center, column);
  cursor: pointer;
  transition: $transition-base;
  transform: translateX(-50%) translateY(-50%);
  z-index: 10;
  border: 2px solid transparent;
  overflow: hidden;

  &:hover:not(.undeveloped) {
    transform: translateX(-50%) translateY(-50%) scale(1.15);
    transition: all 0.3s $ease-smooth;

    .levelTooltip {
      opacity: 1;
      visibility: visible;
      transform: translate(-50%, 0);
    }
  }

  // 未開發的功能（灰色）
  &.undeveloped {
    background: $level-undeveloped-bg;
    border-color: rgba($black-color, 0.2);
    cursor: not-allowed;
    box-shadow: $shadow-sm;
  }

  // 鎖定狀態 - 灰色
  &.locked {
    background: $level-undeveloped-bg;
    border-color: rgba($black-color, 0.2);
    box-shadow: $shadow-md;
  }

  // 已解鎖 - 藍發光效果
  &.unlocked {
    background: $gradient-primary;
    border-color: rgba($white-color, 0.8);
    box-shadow:
      0 0 0.9375rem rgba($primary-color, 0.5),
      0 0.25rem 0.625rem rgba($primary-color, 0.3),
      inset 0 -0.125rem 0.5rem rgba($black-color, 0.2);

    &::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 50%;
      background: linear-gradient(180deg, rgba($white-color, 0.3) 0%, transparent 100%);
      border-radius: $radius-full $radius-full 0 0;
      pointer-events: none;
    }
  }

  // 進行中 - 粉紅脈動發光
  &.in-progress {
    background: $gradient-in-progress;
    border-color: rgba($white-color, 0.8);
    box-shadow:
      0 0 1.25rem $level-in-progress-glow,
      0 0.25rem 0.75rem rgba($accent-color, 0.4),
      inset 0 -0.125rem 0.5rem rgba($black-color, 0.2);
    animation: gemPulse 2s ease-in-out infinite;

    &::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 50%;
      background: linear-gradient(180deg, rgba($white-color, 0.4) 0%, transparent 100%);
      border-radius: $radius-full $radius-full 0 0;
      pointer-events: none;
    }
  }

  // 已完成 - 綠光
  &.completed {
    background: $gradient-completed;
    border-color: rgba($white-color, 0.5);
    box-shadow:
      0 0 1.25rem rgba($execution-color, 0.6),
      0 0.25rem 0.75rem rgba($execution-color, 0.4),
      inset 0 -0.125rem 0.5rem rgba($black-color, 0.2);

    &::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 50%;
      background: linear-gradient(180deg, rgba($white-color, 0.3) 0%, transparent 100%);
      border-radius: $radius-full $radius-full 0 0;
      pointer-events: none;
    }
  }
}

@keyframes gemPulse {
  0%, 100% {
    box-shadow:
      0 0 1.25rem $level-in-progress-glow,
      0 0.25rem 0.75rem rgba($accent-color, 0.4),
      inset 0 -0.125rem 0.5rem rgba($black-color, 0.2);
  }
  50% {
    box-shadow:
      0 0 2.5rem $level-in-progress-glow-strong,
      0 0.25rem 0.75rem rgba($accent-color, 0.6),
      inset 0 -0.125rem 0.5rem rgba($black-color, 0.2);
  }
}

.nodeContent {
  @include flex(center, center, column);
  gap: $spacing-2xs;
  color: $white-color;
  text-align: center;
  position: relative;
  z-index: 1;

  .icon {
    font-size: $font-xl;
    filter: drop-shadow(0 1px 2px rgba($black-color, 0.5));
  }

  .levelName {
    font-size: $font-xs;
    font-weight: 700;
    opacity: 0.95;
    max-width: 72px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    text-shadow: 0 1px 2px rgba($black-color, 0.8);
  }
}

.stars {
  @include flex-center;
  gap: 2px;
  margin-top: 2px;
  filter: drop-shadow(0 1px 2px rgba($black-color, 0.6));
}

.levelTooltip {
  position: absolute;
  top: calc(100% + $spacing-sm);
  left: 50%;
  transform: translate(-50%, 8px);
  background: rgba($dark-bg-tertiary, 0.95);
  color: $white-color;
  padding: $spacing-xs $spacing-sm;
  border-radius: $radius-md;
  border: 1px solid rgba($white-color, 0.1);
  white-space: nowrap;
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.5px;
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
  transition: $transition-base;
  z-index: 100;
  backdrop-filter: blur(8px);
  box-shadow: $shadow-lg;
}

// 響應式設計
@media (max-width: $mobile-max) {
  .levelNode {
    width: 4rem; // 64px
    height: 4rem; // 64px

    .nodeContent {
      gap: 1px;

      .icon {
        font-size: $font-lg;
      }

      .levelName {
        font-size: 10px;
        max-width: 56px;
      }
    }
  }
}
